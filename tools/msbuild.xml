<?xml version="1.0" encoding="utf-8"?>
<Project ToolsVersion="4.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
<Target Name="Foo">
    <Exec Command="git describe > gitdescribe.txt" />
    <ReadLinesFromFile File="gitdescribe.txt">
        <Output TaskParameter="Lines" PropertyName="GitDescribe" /> 
    </ReadLinesFromFile>
    <Delete Files="gitdescribe.txt" />
    <PropertyGroup>
    	<MyGitDescribe Condition="'$(GitDescribe)' != ''">
    	$([System.Text.RegularExpressions.Regex]::Match($(GitDescribe),'v(.+)').Groups[1].Value.Trim())</MyGitDescribe>
    	<MyGitTag Condition="'$(GitDescribe)' != ''">
    	$([System.Text.RegularExpressions.Regex]::Match($(GitDescribe),'v([0-9\.]+).*').Groups[1].Value.Trim())</MyGitTag>
    	<MyGitTagCommits Condition="'$(GitDescribe)' != ''">
    	$([System.Text.RegularExpressions.Regex]::Match($(GitDescribe),'v([0-9\.\-]+)-g.*').Groups[1].Value.Trim())</MyGitTagCommits>
   </PropertyGroup>
	
	<!-- <Message Text="Git describe: $(GitDescribe)" /> -->
	<Message Text="MyGitDescribe: $(MyGitDescribe)" />
	<Message Text="MyGitTag: $(MyGitTag)" />
	<Message Text="MyGitTagCommits: $(MyGitTagCommits)" />
	
</Target>
</Project>